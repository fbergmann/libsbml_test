##
## Filename    : Makefile
## Description : Builds a SWIG generated libSBML Java module
## Author(s)   : SBML Development Group <sbml-team@caltech.edu>
## Organization: JST ERATO Kitano Symbiotic Systems Project
## Created     : 2004-04-02
## Revision    : $Id$
## Source      : $Source$
##
## Copyright 2004 California Institute of Technology and
## Japan Science and Technology Corporation.
##
## This library is free software; you can redistribute it and/or modify it
## under the terms of the GNU Lesser General Public License as published
## by the Free Software Foundation; either version 2.1 of the License, or
## any later version.
##
## This library is distributed in the hope that it will be useful, but
## WITHOUT ANY WARRANTY, WITHOUT EVEN THE IMPLIED WARRANTY OF
## MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  The software and
## documentation provided hereunder is on an "as is" basis, and the
## California Institute of Technology and Japan Science and Technology
## Corporation have no obligations to provide maintenance, support,
## updates, enhancements or modifications.  In no event shall the
## California Institute of Technology or the Japan Science and Technology
## Corporation be liable to any party for direct, indirect, special,
## incidental or consequential damages, including lost profits, arising
## out of the use of this software and its documentation, even if the
## California Institute of Technology and/or Japan Science and Technology
## Corporation have been advised of the possibility of such damage.  See
## the GNU Lesser General Public License for more details.
##
## You should have received a copy of the GNU Lesser General Public License
## along with this library; if not, write to the Free Software Foundation,
## Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.
##
## The original code contained here was initially developed by:
##
##     Ben Bornstein and Ben Kovitz
##     The Systems Biology Markup Language Development Group
##     ERATO Kitano Symbiotic Systems Project
##     Control and Dynamical Systems, MC 107-81
##     California Institute of Technology
##     Pasadena, CA, 91125, USA
##
##     http://www.cds.caltech.edu/erato
##     mailto:sysbio-team@caltech.edu
##
## Contributor(s):
##


##
## NOTES:
##
## Until the appropriate autoconf/automake support comes online:
##
## - CPPFLAGS CFLAGS, LDFLAGS are assumed to come from the user's
##   environment.
##
## - CPPFLAGS should contain one or more include paths (-Ipath) that
##   point to *installed* libsbml and either Xerces-C++ or Expat
##   header files.  Building the SWIG module against an uninstalled
##   libsbml.la in ../src requires a better understanding of libtool.
##
## - LDFLAGS should contain one more library paths (-Lpath) that
##   point to libsbml.so and either libxerces-c.so and/or libexpat.so.
##
## - For Linux/Unix LD_LIBRARY_PATH *may* need to contain one or more
##   library paths to libsbml.so, libxerces-c.so and/or libexpat.so
##   and/or the libsbml.so _libsbml.so generated by this Makfile.
##   (For BSD/MacOS X replace LD_LIBRARY_PATH with DYLIB_LIBRARY_PATH.)
##
## - MacOS X requires both -lsbml and -lxerces-c (-lexpat) LIBS be
##   specified when linking.  Linux requires only -lsbml.
##
## - There is no install process (yet) for the library generated by this
##   Makefile.
##

JAVAPACKAGE = libsbml

CC  = gcc
CXX = g++

##
## Linux
##
JDK       = /usr/local/java/jdk1.4.1_01
SWIGFLAGS = $(CPPFLAGS) -c++ -java -package $(JAVAPACKAGE) -outdir src
XCPPFLAGS = $(CPPFLAGS) -I../swig -I$(JDK)/include -I$(JDK)/include/linux
XCFLAGS   = $(CFLAGS) -fpic -shared
XLDFLAGS  = $(LDFLAGS)
LIBS      = -lsbml -lxerces-c


all: libsbmlj.so test

libsbmlj.so: libsbml_wrap.cpp
	$(CXX) $(XCPPFLAGS) $(XCFLAGS) $(XLDFLAGS) $< -o $@ $(LIBS)

libsbml_wrap.cpp: libsbml.i
	swig $(SWIGFLAGS) -o libsbml_wrap.cpp libsbml.i
	javac -d classes src/*.java

test: libsbmlj.so
	javac -classpath classes -d classes Test.java
	java  -classpath classes Test

clean:
	/bin/rm -f libsbml_wrap.cpp src/*.java classes/*.class *.so *.log
