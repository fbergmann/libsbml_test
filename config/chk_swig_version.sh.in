#!/bin/sh
# $Id$   -*- Mode: csh -*-
# $URL$
# -----------------------------------------------------------------------------
# Description:  Test the version of SWIG we were configured with
# First Author:	Michael Hucka <mhucka@caltech.edu>
# Organization: California Institute of Technology
# -----------------------------------------------------------------------------

SWIG="@SWIG@"
NEED="@SWIGNEEDVERSION@"

if ! ($SWIG -version > /dev/null 2>&1); then
  echo 
  echo One or more of the dependencies required to compile a file in the
  echo libSBML language bindings has changed, but libSBML cannot find the
  echo program \'swig\' and thus cannot proceed.  Please re-run the libSBML
  echo \'configure\' program using the --with-swig option to indicate where
  echo the configure program can find \'swig\' version $NEED or later.
  echo 
  exit 1;
fi

rx=`echo $NEED | sed -e 's/\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\).*/\1/'`
ry=`echo $NEED | sed -e 's/\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\).*/\2/'`
rz=`echo $NEED | sed -e 's/\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\).*/\3/'`

version=`"$SWIG" -version 2>&1`

sx=`echo $version | sed -e 's/SWIG Version \([0-9]*\)\.\([0-9]*\)\.\([0-9]*\).*/\1/'`
sy=`echo $version | sed -e 's/SWIG Version \([0-9]*\)\.\([0-9]*\)\.\([0-9]*\).*/\2/'`
sz=`echo $version | sed -e 's/SWIG Version \([0-9]*\)\.\([0-9]*\)\.\([0-9]*\).*/\3/'`

if test $sx -gt $rx \
    || (test $sx -eq $rx && test $sy -gt $ry) \
    || (test $sx -eq $rx && test $sy -eq $ry && test $sz -ge $rz); then
    exit 0;
else
  echo 
  echo One or more of the dependencies required to compile a file in the
  echo libSBML language bindings has changed, but the version of \'swig\'
  echo found \($sx.$sy.$sz\) by the libSBML build system is too old.  Please
  echo re-run the libSBML \'configure\' program using the --with-swig
  echo option to indicate where the configure program can find \'swig\'
  echo version $NEED or later.
  echo 
  exit 1;
fi
